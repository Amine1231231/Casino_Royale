<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>League Tournament</title>
</head>
<body>
  <h1>Create Tournament</h1>

  <label>League Name:
    <input type="text" id="leagueName">
  </label>
  <br>
  <label>Players (comma separated):
    <input type="text" id="players">
  </label>
  <br>
  <button id="createBtn">Create League</button>
  <div id="message"></div>

  <h2>League Data</h2>
  <button id="loadBtn">Load League Rounds</button>
  <pre id="leagueOutput"></pre>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbysbCfrwj_GQ7V4DvCpSsvCtToVL28vcCF95RsR__StmbzqwG4pA7WayXW7SC9f8HcIzw/exec";

    async function callAPI(action, data = {}) {
      const formData = new FormData();
      formData.append("action", action);
      for (const key in data) formData.append(key, data[key]);

      const res = await fetch(SCRIPT_URL, { method: "POST", body: formData });
      return res.json();
    }

    document.getElementById("createBtn").addEventListener("click", async () => {
      const leagueName = document.getElementById("leagueName").value.trim();
      const players = document.getElementById("players").value
        .split(",")
        .map(p => p.trim())
        .filter(p => p);

      if (!leagueName || players.length < 2) {
        document.getElementById("message").textContent = "Enter name and at least 2 players.";
        return;
      }

      const result = await callAPI("createLeague", {
        leagueName,
        players: JSON.stringify(players)
      });

      document.getElementById("message").textContent = result.success ? result.message : result.message;
    });

    document.getElementById("loadBtn").addEventListener("click", async () => {
      const result = await callAPI("getLeagueRounds");
      if (result.success) {
        document.getElementById("leagueOutput").textContent = JSON.stringify(result.data, null, 2);
      } else {
        document.getElementById("leagueOutput").textContent = result.message;
      }
    });
  </script>
</body>
</html>
